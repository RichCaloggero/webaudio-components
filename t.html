<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Test</title>
</head>
<body> 

<div>
<br><label>radius: <input type="number" id="r" value="1"></label>
<label>delta angle: <input type="number" id="delta-angle" value=".1"></label>
</div>


<script type="module">
import {AudioComponent, audioContext} from "./audioComponent.js";
import * as audio from "./components.js";
import * as setop from "./setops.js";
import {getValue, setValue} from "./binder.js";

const media = document.querySelector("audio");

document.body.appendChild(audio.app("",
audio.series("hide=mix, bypass, silentBypass",
window.player = audio.player("show=media, play, position"),
window.panner = audio.panner("panningModel=HRTF; maxDistance=100; refDistance=10; orientationX=0"),
window.xtc = audio.xtc("mix=0.3; feedback=0.82; delay=0.00009; gain=-2; lowType=lowShelf; lowGain=-20; lowFrequency=500; lowQ=.26; midType=bandpass; midFrequency=950; midQ=.6; highType=peaking; highFrequency=8000; highGain=-15; highQ=.6"),
audio.destination()
) // series
)); // audio.app

const p = panner.webaudioNode;
p.channelCount = 1;
let a = 0;
setInterval(() => {
const r = Number(getValue(document.querySelector("#r")));
const dA = Number(getValue(document.querySelector("#delta-angle")));

const x = document.querySelector("[data-name=positionX]");
const y = document.querySelector("[data-name=positionY]");
const z = document.querySelector("[data-name=positionZ]");

setValue(x, r * Math.cos(a), "change");
//setValue(y, r * Math.sin(a + Math.PI/4), "change");
setValue(z, r * Math.sin(a), "change");

a += dA;
}, 50);

</script>

</body>
</html>
